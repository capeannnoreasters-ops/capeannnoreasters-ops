<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Nor’easters — Squares Boards</title>
  <link rel="icon" href="./assets/logo-wordmark.png"/>
  <style>
    :root{--brand:#1e3a8a;--brand2:#60a5fa;--bg:#f8fafc;--card:#fff;--border:#e2e8f0;--ink:#0f172a;--muted:#475569}
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .hero{background:linear-gradient(135deg, rgba(30,58,138,.95), rgba(96,165,250,.85));color:#fff;border-radius:16px;padding:16px;display:flex;align-items:center;gap:12px}
    .hero img{height:58px;background:#fff;border-radius:12px;padding:6px}
    h1{margin:0;font-size:20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
    .title{font-weight:700}
    .meta{font-size:12px;color:var(--muted);margin:6px 0}
    .btn{display:inline-block;background:var(--brand);color:#fff;padding:8px 12px;border-radius:10px;text-decoration:none}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <img src="./assets/logo-full.png" alt="Logo" onerror="this.style.display='none'"/>
      <div>
        <h1>Cape Ann Nor’easters — Football Squares</h1>
        <div class="small">Pick a board, buy squares, and support the team</div>
      </div>
      <div style="margin-left:auto" class="row">
        <a class="btn" href="./admin.html">Admin</a>
      </div>
    </div>

    <h2 style="margin:12px 0 8px 0;font-size:16px;color:var(--brand)">Open Boards</h2>
    <div id="boards" class="grid"></div>
  </div>

  <script type="module">
    const SUPABASE_URL = "https://jpzxvnqjsixvnwzjfxuh.supabase.co";
    const SUPABASE_ANON_KEY = "PASTE_YOUR_ANON_KEY_HERE";
    const { createClient } = await import("https://esm.sh/@supabase/supabase-js@2.45.4");
    const sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, { auth:{persistSession:false} });
    const root = document.getElementById("boards");

    const { data, error } = await sb.from("boards")
      .select("slug,title,game_date,cost_per_square,is_open")
      .eq("is_open", true)
      .order("game_date", { ascending: true });
    root.innerHTML = "";

    if (error) {
      root.innerHTML = `<div class="card">Failed to load boards.</div>`;
    } else if (!data || data.length===0) {
      root.innerHTML = `<div class="card">No open boards yet. Check back soon.</div>`;
    } else {
      for (const b of data) {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <div class="title">${b.title}</div>
          <div class="meta">${b.game_date ?? ""} • $${b.cost_per_square}/square</div>
          <a class="btn" href="./public.html?board=${encodeURIComponent(b.slug)}">Buy Squares</a>
        `;
        root.appendChild(div);
      }
    }
  </script>
</body>
</html>
